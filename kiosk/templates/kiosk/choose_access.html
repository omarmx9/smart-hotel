{% extends 'base.html' %}

{% block title %}Choose Access Method - Smart Hotel{% endblock %}

{% block content %}
<div class="access-page">
    <div class="card p-4 p-md-5">
        <div class="access-header">
            <h1 data-i18n="choose_access_title" data-i18n-res="{{ reservation.reservation_number }}">Choose Access Method</h1>
            <p class="lead">How would you like to access your room?</p>
        </div>
        <form method="post" id="accessForm">
        {% csrf_token %}
        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}
        
        <div class="access-grid mb-4">
            <button type="button" class="access-btn" aria-pressed="{% if preselected_keycard %}true{% else %}false{% endif %}" onclick="toggleAccess(this, 'keycard')">
                <input type="hidden" name="access_keycard" id="keycard" value="{% if preselected_keycard %}1{% endif %}">
                <span class="badge"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/></svg> Selected</span>
                <div class="icon-container">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 16 16"><path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v1h14V4a1 1 0 0 0-1-1H2zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V7z"/><path d="M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1z"/></svg>
                </div>
                <span class="title" data-i18n="keycard">Keycard</span>
                <span class="desc">Traditional room key</span>
            </button>
            <button type="button" class="access-btn" aria-pressed="{% if preselected_face %}true{% else %}false{% endif %}" onclick="toggleAccess(this, 'face')">
                <input type="hidden" name="access_face" id="face" value="{% if preselected_face %}1{% endif %}">
                <span class="badge"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/></svg> Selected</span>
                <div class="icon-container">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
                </div>
                <span class="title" data-i18n="face">Face ID</span>
                <span class="desc">Contactless entry</span>
            </button>
        </div>

        <button type="submit" class="btn btn-primary btn-lg w-100">
            <span data-i18n="confirm_access">Confirm Access Method</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16" style="margin-left: 8px;"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg>
        </button>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function toggleAccess(btn, inputId) {
    var isPressed = btn.getAttribute('aria-pressed') === 'true';
    var newState = !isPressed;
    
    btn.setAttribute('aria-pressed', String(newState));
    document.getElementById(inputId).value = newState ? '1' : '';
}

document.getElementById('accessForm').onsubmit = function(e) {
    var keycard = document.getElementById('keycard').value;
    var face = document.getElementById('face').value;
    if (!keycard && !face) {
        e.preventDefault();
        alert('Please choose at least one access method.');
    }
};
</script>
{% endblock %}
